name: Auto Deploy Development

on:
  push:
    branches: [ develop ]

jobs:
  deploy-dev:
    runs-on: windows-latest
    if: github.ref == 'refs/heads/develop'
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Setup .NET
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: '8.0.x'
        
    - name: Restore dependencies
      run: dotnet restore ReturnToMoriaServerManager.sln
      
    - name: Build
      run: dotnet build ReturnToMoriaServerManager.sln --no-restore --configuration Release
      
    - name: Publish
      run: dotnet publish ReturnToMoriaServerManager/ReturnToMoriaServerManager.csproj --configuration Release --output ./publish --self-contained false
      
    - name: Create Development Release
      uses: softprops/action-gh-release@v2
      with:
        tag_name: dev-${{ github.sha }}
        name: Development Build ${{ github.sha }}
        body: |
          ## Development Build
          
          This is an automatic development build from the `develop` branch.
          
          **Commit:** ${{ github.sha }}
          **Branch:** ${{ github.ref_name }}
          **Date:** ${{ github.event.head_commit.timestamp }}
          
          ### Download
          Download the latest development build from the assets below.
          
          ### Installation
          1. Extract the ZIP file
          2. Run `ReturnToMoriaServerManager.exe`
          3. Follow the setup wizard
          
          ### Note
          This is a development build and may contain bugs or incomplete features.
        files: |
          ./publish/**/*
        draft: false
        prerelease: true
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} 